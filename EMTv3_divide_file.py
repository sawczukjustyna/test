import io
import urllib.parse
import pandas as pd
import csv
import boto3
import aim_helpers
s3 = boto3.client('s3')


def transform(fileRequest, bucketResponse, keyResponse):
    message=''
    result = []
    try:
        data=pd.DataFrame()
        bucket = fileRequest['bucket']
        key = urllib.parse.unquote_plus(fileRequest["key"], encoding='ISO-8859-1') #str
        s3File = s3.get_object(Bucket=bucket, Key=key) #dict
        file_content = s3File["Body"].read()
        
        path = io.BytesIO(file_content)
        
        if str(key)[-4:]==".csv":
            csv_dialect = csv.Sniffer().sniff(file_content.decode('ISO-8859-1'), ['|',';','\t',','])
            data=pd.read_csv(path, encoding='ISO-8859-1', sep=csv_dialect.delimiter, engine='python')
        else:
            data = pd.read_excel(path)
        data['EMTv3_Collection'] = 'True'
        df_columns = data.columns
        if 'General' in df_columns:
            for i, row in data.iterrows():
                if pd.isnull(row['General'])==False:
                    data = data.drop(i)
                    continue
                if pd.isnull(row['TargetMarket'])==False:
                    data.at[i, "00006_EMT_Data_Reporting_Target_Market"] = "Incorrect"
                if pd.isnull(row['ExAnte'])==False:
                    data.at[i, "00007_EMT_Data_Reporting_Ex_Ante"] = "Incorrect"
                if pd.isnull(row['ExPost'])==False:
                    data.at[i, "00008_EMT_Data_Reporting_Ex_Post"] = "Incorrect"
        
        
        d_6_7_8 =['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00007_EMT_Data_Reporting_Ex_Ante', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
        d_6_7 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00007_EMT_Data_Reporting_Ex_Ante', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '07160_Ex_Ante_Costs_Reference_Date','EMTv3_Collection']
        d_6_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
        d_7_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00007_EMT_Data_Reporting_Ex_Ante', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
        d_6 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management','EMTv3_Collection']
        d_7 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00007_EMT_Data_Reporting_Ex_Ante', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', 'EMTv3_Collection']
        d_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy','08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
        d = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', 'EMTv3_Collection']
        created_files = 0
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
        if checked.empty==False:
            for header in d_6_7_8:
                if header not in df_columns:
                    d_6_7_8.remove(header)
            created_files = created_files + 1
            fileName = "File_6_7_8.xlsx"
            aim_helpers.save_excel(fileName, checked[d_6_7_8], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
            
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
        if checked.empty==False:
            for header in d_6_7:
                if header not in df_columns:
                    d_6_7.remove(header)
            created_files = created_files + 1
            fileName = "File_6_7.xlsx"
            aim_helpers.save_excel(fileName, checked[d_6_7], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
        if checked.empty==False:
            for header in d_6_8:
                if header not in df_columns:
                    d_6_8.remove(header)
            created_files = created_files + 1
            fileName = "File_6_8.xlsx"
            aim_helpers.save_excel(fileName, checked[d_6_8], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
        if checked.empty==False:
            for header in d_7_8:
                if header not in df_columns:
                    d_7_8.remove(header)
            created_files = created_files + 1
            fileName = "File_7_8.xlsx"
            aim_helpers.save_excel(fileName, checked[d_7_8], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
        if checked.empty==False:
            for header in d_6:
                if header not in df_columns:
                    d_6.remove(header)
            created_files = created_files + 1
            fileName = "File_6.xlsx"
            aim_helpers.save_excel(fileName, checked[d_6], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
        if checked.empty==False:
            for header in d_7:
                if header not in df_columns:
                    d_7.remove(header)
            created_files = created_files + 1
            fileName = "File_7.xlsx"
            aim_helpers.save_excel(fileName, checked[d_7], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
        if checked.empty==False:
            for header in d_8:
                if header not in df_columns:
                    d_8.remove(header)
            created_files = created_files + 1
            fileName = "File_8.xlsx"
            aim_helpers.save_excel(fileName, checked[d_8], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
        if checked.empty==False:
            for header in d:
                if header not in df_columns:
                    d.remove(header)
            created_files = created_files + 1
            fileName = "File_main.xlsx"
            aim_helpers.save_excel(fileName, checked[d], bucketResponse, index=False)
            fileResponse = {'bucket': bucketResponse, 'key': fileName}
            fileResult = {
                                'operationStatus': 'Success',
                                'file': fileResponse
                                }
            result.append(fileResult)
        if created_files == 0:
            message = message + 'No file created'
            fileResult = {
                            'operationStatus': 'Failed'
                            }
            result.append(fileResult)
    except Exception as e:
        message = message + 'error:' + str(e)
        fileResult = {
                                'operationStatus': 'Failed'
                                }
        result.append(fileResult)
        
    return result

# def validation():
#     message_errors=''
#     message=''
#     result = {
#         'message': message,
#         'operationStatus': 'Success'
#     }
#     message = ''
#     status = 'Success'
#     filePath = "C:/Users/jus/Desktop/2_001_Aws-lambda_000001_EMTv3_file.xlsx_validated_result (3).xlsx"
#     data = pd.read_excel(filePath)
#     data['EMTv3_Collection'] = 'True'
#     df_columns = data.columns
#     if 'General' in df_columns:
#         for i, row in data.iterrows():
#             if pd.isnull(row['General'])==False:
#                 data = data.drop(i)
#                 continue
#             if pd.isnull(row['TargetMarket'])==False:
#                 data.at[i, "00006_EMT_Data_Reporting_Target_Market"] = "Incorrect"
#             if pd.isnull(row['ExAnte'])==False:
#                 data.at[i, "00007_EMT_Data_Reporting_Ex_Ante"] = "Incorrect"
#             if pd.isnull(row['ExPost'])==False:
#                 data.at[i, "00008_EMT_Data_Reporting_Ex_Post"] = "Incorrect"
    
#     print(data)
#     d_6_7_8 =['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00007_EMT_Data_Reporting_Ex_Ante', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
#     d_6_7 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00007_EMT_Data_Reporting_Ex_Ante', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '07160_Ex_Ante_Costs_Reference_Date','EMTv3_Collection']
#     d_6_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
#     d_7_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00007_EMT_Data_Reporting_Ex_Ante', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', '08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
#     d_6 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00006_EMT_Data_Reporting_Target_Market', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '01000_Target_Market_Reference_Date', '01010_Investor_Type_Retail', '01020_Investor_Type_Professional', '01030_Investor_Type_Eligible_Counterparty', '02010_Basic_Investor', '02020_Informed_Investor', '02030_Advanced_Investor', '02040_Expert_Investor_Germany', '03010_Compatible_With_Clients_Who_Can_Not_Bear_Capital_Loss', '03020_Compatible_With_Clients_Who_Can_Bear_Limited_Capital_Loss', '03030_Limited_Capital_Loss_Level', '03040_Compatible_With_Clients_Who_Do_Not_Need_Capital_Guarantee', '03050_Compatible_With_Clients_Who_Can_Bear_Loss_Beyond_Capital', '04010_Risk_Tolerance_PRIIPS_Methodology', '04020_Risk_Tolerance_UCITS_Methodology', '04030_Risk_Tolerance_Internal_Methodology_For_Non_PRIIPS_And_Non_UCITS', '04040_Risk_Tolerance_For_Non_PRIIPS_And_Non_UCITS_Spain', '04050_Not_For_Investors_With_The_Lowest_Risk_Tolerance_Germany', '05010_Return_Profile_Client_Looking_For_Preservation', '05020_Return_Profile_Client_Looking_For_Capital_Growth', '05030_Return_Profile_Client_Looking_For_Income', '05040_Return_Profile_Hedging', '05050_Option_Or_Leveraged_Return_Profile', '05070_Return_Profile_Pension_Scheme_Germany', '05080_Minimum_Recommended_Holding_Period', '05105_Intended_Compatible_With_Clients_Having_ESG_Preferences', '05115_Other_Specific_Investment_Need', '06010_Execution_Only', '06020_Execution_With_Appropriateness_Test_Or_Non_Advised_Services', '06030_Investment_Advice', '06040_Portfolio_Management','EMTv3_Collection']
#     d_7 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00007_EMT_Data_Reporting_Ex_Ante', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', '07020_Gross_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Non_Acquired', '07025_Net_One-off_Cost_Structured_Products_Entry_Cost_Non_Acquired', '07030_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Fixed_Amount_Italy', '07040_One-off_Cost_Financial_Instrument_Maximum_Entry_Cost_Acquired', '07050_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Non_Acquired', '07060_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Fixed_Amount_Italy', '07070_One-off_Costs_Financial_Instrument_Maximum_Exit_Cost_Acquired', '07080_One-off_Costs_Financial_Instrument_Typical_Exit_Cost', '07090_One-off_Cost_Financial_Instrument_Exit_Cost_Structured_Products_Prior_RHP', '07100_Financial_Instrument_Gross_Ongoing_Costs', '07105_Financial_Instrument_Borrowing_Costs_Ex_Ante_UK', '07110_Financial_Instrument_Management_Fee', '07120_Financial_Instrument_Distribution_Fee', '07130_Financial_Instrument_Transaction_Costs_Ex_Ante', '07140_Financial_Instrument_Incidental_Costs_Ex_Ante', '07150_Structured_Securities_Reference_Price_Ex_Ante', '07155_Structured_Securities_Notional_Reference_Amount_Ex_Ante', '07160_Ex_Ante_Costs_Reference_Date', 'EMTv3_Collection']
#     d_8 = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00008_EMT_Data_Reporting_Ex_Post', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy','08010_Gross_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08015_Net_One-off_Cost_Structured_Securities_Entry_Cost_Ex_Post', '08020_One-off_Costs_Structured_Securities_Exit_Cost_Ex_Post', '08025_One-off_Cost_Financial_Instrument_Entry_Cost_Acquired', '08030_Financial_Instrument_Ongoing_Costs_Ex_Post', '08040_Structured_Securities_Ongoing_Costs_Ex_Post_Accumulated', '08045_Financial_Instrument_Borrowing_Costs_Ex_Post_UK', '08050_Financial_Instrument_Management_Fee_Ex_Post', '08060_Financial_Instrument_Distribution_Fee_Ex_Post', '08070_Financial_Instrument_Transaction_Costs_Ex_Post', '08080_Financial_Instrument_Incidental_Costs_Ex_Post', '08090_Beginning_Of_Reference_Period', '08100_End_Of_Reference_Period', '08110_Structured_Securities_Reference_Price_Ex_Post', '08120_Structured_Securities_Notional_Reference_Amount','EMTv3_Collection']
#     d = ['00001_EMT_Version', '00002_EMT_Producer_Name', '00003_EMT_Producer_LEI', '00004_EMT_Producer_Email', '00005_File_Generation_Date_And_Time', '00010_Financial_Instrument_Identifying_Data', '00020_Type_Of_Identification_Code_For_The_Financial_Instrument', '00030_Financial_Instrument_Name', '00040_Financial_Instrument_Currency', '00045_Financial_Instrument_Performance_Fee', '00047_Financial_Instrument_Distribution_Of_Cash', '00050_General_Reference_Date', '00060_Financial_Instrument_Product_Type', '00065_Maturity_Date', '00067_May_Be_Terminated_Early', '00070_Financial_Instrument_Manufacturer_Name', '00073_Financial_Instrument_Manufacturer_LEI', '00074_Financial_Instrument_Manufacturer_Email', '00075_Financial_Instrument_Manufacturer_Product_Governance_Process', '00080_Financial_Instrument_Guarantor_Name', '00085_Financial_Instrument_Type_Notional_Or_Item_Based', '00090_Product_Category_Or_Nature_Germany', '00095_Structured_Securities_Product_Category_Or_Nature', '00096_Structured_Securities_Quotation', '00100_Leveraged_Financial_Instrument_Or_Contingent_Liability_Instrument', '00110_Fund_Share_Class_Without_Retrocession', '00120_Ex_Post_Cost_Calculation_Basis_Italy', 'EMTv3_Collection']
    
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
    
    
#     if checked.empty==False:
#         for header in d_6_7_8:
#             if header not in df_columns:
#                 d_6_7_8.remove(header)
#         checked[d_6_7_8].to_excel("File_6_7_8.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_6_7_8.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_6_7_8], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
#     if checked.empty==False:
#         for header in d_6_7:
#             if header not in df_columns:
#                 d_6_7.remove(header)
#         checked[d_6_7].to_excel("File_6_7.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_6_7.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_6_7], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
#     if checked.empty==False:
#         for header in d_6_8:
#             if header not in df_columns:
#                 d_6_8.remove(header)
#         checked[d_6_8].to_excel("File_6_8.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_6_8.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_6_8], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
#     if checked.empty==False:
#         for header in d_7_8:
#             if header not in df_columns:
#                 d_7_8.remove(header)
#         checked[d_7_8].to_excel("File_7_8.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_7_8.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_7_8], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']=="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
#     if checked.empty==False:
#         for header in d_6:
#             if header not in df_columns:
#                 d_6.remove(header)
#         checked[d_6].to_excel("File_6.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_6.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_6], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']=="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
#     if checked.empty==False:
#         for header in d_7:
#             if header not in df_columns:
#                 d_7.remove(header)
#         checked[d_7].to_excel("File_7.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_7.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_7], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']=="Y")]
#     if checked.empty==False:
#         for header in d_8:
#             if header not in df_columns:
#                 d_8.remove(header)
#         checked[d_8].to_excel("File_8.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_8.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d_8], bucketResponse, index=False)
#     checked = data.loc[(data['00006_EMT_Data_Reporting_Target_Market']!="Y") & (data['00007_EMT_Data_Reporting_Ex_Ante']!="Y") & (data['00008_EMT_Data_Reporting_Ex_Post']!="Y")]
#     if checked.empty==False:
#         for header in d:
#             if header not in df_columns:
#                 d.remove(header)
#         checked[d].to_excel("File_main.xlsx", header = True, index = False)
#         # fileName = keyResponse + "File_main.xlsx"
#         # aim_helpers.save_excel(fileName, checked[d], bucketResponse, index=False)
    
#     reportName="EMTv3_file_marked.xlsx"
#     data.to_excel(reportName,header=True, index = False)


# if __name__ == '__main__':
#     validation()

# #window.mainloop()